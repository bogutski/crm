{
  "openapi": "3.0.3",
  "info": {
    "title": "ClientBase API",
    "version": "1.0.0",
    "description": "# ClientBase API\n\nREST API для CRM системы.\n\n## Аутентификация\n\nAPI использует cookie-based аутентификацию через NextAuth.js.\nДля доступа к защищённым эндпоинтам необходимо авторизоваться через `/login`.\n\n## Ошибки\n\nВсе ошибки возвращаются в формате:\n\n```json\n{\n  \"error\": \"Описание ошибки\"\n}\n```\n\nСтандартные коды ответов:\n- `200` - Успешный запрос\n- `201` - Ресурс создан\n- `400` - Неверный запрос (ошибка валидации)\n- `401` - Не авторизован\n- `403` - Доступ запрещён\n- `404` - Ресурс не найден\n- `500` - Внутренняя ошибка сервера"
  },
  "servers": [
    {
      "url": "http://localhost:3000",
      "description": "Development"
    }
  ],
  "paths": {
    "/api/contacts/search": {
      "post": {
        "summary": "Поиск контактов",
        "description": "Возвращает список контактов с пагинацией и возможностью фильтрации. Фильтры передаются в теле запроса.",
        "tags": [
          "Контакты"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "contacts": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Уникальный идентификатор"
                          },
                          "name": {
                            "type": "string",
                            "description": "Имя контакта"
                          },
                          "emails": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "address": {
                                  "type": "string",
                                  "description": "Email адрес",
                                  "format": "email"
                                },
                                "isVerified": {
                                  "type": "boolean",
                                  "default": false
                                },
                                "isSubscribed": {
                                  "type": "boolean",
                                  "default": true
                                },
                                "unsubscribedAt": {
                                  "type": "string",
                                  "format": "date-time"
                                },
                                "bouncedAt": {
                                  "type": "string",
                                  "format": "date-time"
                                },
                                "lastEmailedAt": {
                                  "type": "string",
                                  "format": "date-time"
                                }
                              },
                              "required": [
                                "address"
                              ],
                              "description": "Email контакта"
                            },
                            "description": "Список email адресов"
                          },
                          "phones": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "e164": {
                                  "type": "string",
                                  "description": "Номер в формате E.164 (+71234567890)",
                                  "minLength": 1
                                },
                                "international": {
                                  "type": "string",
                                  "description": "Международный формат (+7 123 456-78-90)",
                                  "minLength": 1
                                },
                                "country": {
                                  "type": "string",
                                  "description": "Код страны ISO 3166-1 alpha-2"
                                },
                                "type": {
                                  "type": "string",
                                  "enum": [
                                    "MOBILE",
                                    "FIXED_LINE",
                                    "UNKNOWN"
                                  ],
                                  "description": "Тип телефона",
                                  "default": "UNKNOWN"
                                },
                                "isPrimary": {
                                  "type": "boolean",
                                  "default": false
                                },
                                "isVerified": {
                                  "type": "boolean",
                                  "default": false
                                },
                                "isSubscribed": {
                                  "type": "boolean",
                                  "default": true
                                },
                                "unsubscribedAt": {
                                  "type": "string",
                                  "format": "date-time"
                                },
                                "lastSmsAt": {
                                  "type": "string",
                                  "format": "date-time"
                                }
                              },
                              "required": [
                                "e164",
                                "international",
                                "country"
                              ],
                              "description": "Телефон контакта"
                            },
                            "description": "Список телефонов"
                          },
                          "company": {
                            "type": "string"
                          },
                          "position": {
                            "type": "string"
                          },
                          "notes": {
                            "type": "string"
                          },
                          "contactType": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "description": "ID типа контакта"
                              },
                              "name": {
                                "type": "string",
                                "description": "Название типа"
                              },
                              "color": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "id",
                              "name"
                            ],
                            "description": "Тип контакта",
                            "nullable": true
                          },
                          "source": {
                            "type": "string"
                          },
                          "ownerId": {
                            "type": "string",
                            "description": "ID владельца"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата создания"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата обновления"
                          }
                        },
                        "required": [
                          "id",
                          "name",
                          "emails",
                          "phones",
                          "ownerId",
                          "createdAt",
                          "updatedAt"
                        ],
                        "description": "Контакт"
                      },
                      "description": "Список контактов"
                    },
                    "total": {
                      "type": "number",
                      "description": "Общее количество"
                    },
                    "page": {
                      "type": "number",
                      "description": "Текущая страница"
                    },
                    "limit": {
                      "type": "number",
                      "description": "Размер страницы"
                    }
                  },
                  "required": [
                    "contacts",
                    "total",
                    "page",
                    "limit"
                  ],
                  "description": "Список контактов с пагинацией"
                },
                "example": {
                  "data": [
                    {
                      "id": "clx1234567890abcdef",
                      "firstName": "Иван",
                      "lastName": "Петров",
                      "middleName": "Сергеевич",
                      "email": "ivan.petrov@example.com",
                      "phone": "+7 (999) 123-45-67",
                      "company": "ООО \"Технологии\"",
                      "position": "Технический директор",
                      "type": "client",
                      "source": "website",
                      "ownerId": "clx0987654321fedcba",
                      "createdAt": "2024-01-15T10:30:00.000Z",
                      "updatedAt": "2024-01-15T10:30:00.000Z"
                    }
                  ],
                  "total": 1,
                  "page": 1,
                  "limit": 20,
                  "totalPages": 1
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "search": {
                    "type": "string"
                  },
                  "ownerId": {
                    "type": "string"
                  },
                  "contactType": {
                    "type": "string"
                  },
                  "source": {
                    "type": "string"
                  },
                  "page": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 1
                  },
                  "limit": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 100,
                    "default": 30
                  }
                },
                "description": "Фильтры для списка контактов"
              }
            }
          }
        }
      }
    },
    "/api/contacts": {
      "post": {
        "summary": "Создать контакт",
        "description": "Создаёт нового контакта. Владельцем автоматически становится текущий пользователь.",
        "tags": [
          "Контакты"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "name": {
                      "type": "string",
                      "description": "Имя контакта"
                    },
                    "emails": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "address": {
                            "type": "string",
                            "description": "Email адрес",
                            "format": "email"
                          },
                          "isVerified": {
                            "type": "boolean",
                            "default": false
                          },
                          "isSubscribed": {
                            "type": "boolean",
                            "default": true
                          },
                          "unsubscribedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "bouncedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "lastEmailedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        },
                        "required": [
                          "address"
                        ],
                        "description": "Email контакта"
                      },
                      "description": "Список email адресов"
                    },
                    "phones": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "e164": {
                            "type": "string",
                            "description": "Номер в формате E.164 (+71234567890)",
                            "minLength": 1
                          },
                          "international": {
                            "type": "string",
                            "description": "Международный формат (+7 123 456-78-90)",
                            "minLength": 1
                          },
                          "country": {
                            "type": "string",
                            "description": "Код страны ISO 3166-1 alpha-2"
                          },
                          "type": {
                            "type": "string",
                            "enum": [
                              "MOBILE",
                              "FIXED_LINE",
                              "UNKNOWN"
                            ],
                            "description": "Тип телефона",
                            "default": "UNKNOWN"
                          },
                          "isPrimary": {
                            "type": "boolean",
                            "default": false
                          },
                          "isVerified": {
                            "type": "boolean",
                            "default": false
                          },
                          "isSubscribed": {
                            "type": "boolean",
                            "default": true
                          },
                          "unsubscribedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "lastSmsAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        },
                        "required": [
                          "e164",
                          "international",
                          "country"
                        ],
                        "description": "Телефон контакта"
                      },
                      "description": "Список телефонов"
                    },
                    "company": {
                      "type": "string"
                    },
                    "position": {
                      "type": "string"
                    },
                    "notes": {
                      "type": "string"
                    },
                    "contactType": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID типа контакта"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название типа"
                        },
                        "color": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Тип контакта",
                      "nullable": true
                    },
                    "source": {
                      "type": "string"
                    },
                    "ownerId": {
                      "type": "string",
                      "description": "ID владельца"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "name",
                    "emails",
                    "phones",
                    "ownerId",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Контакт"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "firstName": "Иван",
                  "lastName": "Петров",
                  "middleName": "Сергеевич",
                  "email": "ivan.petrov@example.com",
                  "phone": "+7 (999) 123-45-67",
                  "company": "ООО \"Технологии\"",
                  "position": "Технический директор",
                  "type": "client",
                  "source": "website",
                  "ownerId": "clx0987654321fedcba",
                  "createdAt": "2024-01-15T10:30:00.000Z",
                  "updatedAt": "2024-01-15T10:30:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Имя контакта",
                    "minLength": 1
                  },
                  "emails": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "address": {
                          "type": "string",
                          "description": "Email адрес",
                          "format": "email"
                        },
                        "isVerified": {
                          "type": "boolean",
                          "default": false
                        },
                        "isSubscribed": {
                          "type": "boolean",
                          "default": true
                        },
                        "unsubscribedAt": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "bouncedAt": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "lastEmailedAt": {
                          "type": "string",
                          "format": "date-time"
                        }
                      },
                      "required": [
                        "address"
                      ],
                      "description": "Email контакта"
                    },
                    "default": []
                  },
                  "phones": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "e164": {
                          "type": "string",
                          "description": "Номер в формате E.164 (+71234567890)",
                          "minLength": 1
                        },
                        "international": {
                          "type": "string",
                          "description": "Международный формат (+7 123 456-78-90)",
                          "minLength": 1
                        },
                        "country": {
                          "type": "string",
                          "description": "Код страны ISO 3166-1 alpha-2"
                        },
                        "type": {
                          "type": "string",
                          "enum": [
                            "MOBILE",
                            "FIXED_LINE",
                            "UNKNOWN"
                          ],
                          "description": "Тип телефона",
                          "default": "UNKNOWN"
                        },
                        "isPrimary": {
                          "type": "boolean",
                          "default": false
                        },
                        "isVerified": {
                          "type": "boolean",
                          "default": false
                        },
                        "isSubscribed": {
                          "type": "boolean",
                          "default": true
                        },
                        "unsubscribedAt": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "lastSmsAt": {
                          "type": "string",
                          "format": "date-time"
                        }
                      },
                      "required": [
                        "e164",
                        "international",
                        "country"
                      ],
                      "description": "Телефон контакта"
                    },
                    "default": []
                  },
                  "company": {
                    "type": "string"
                  },
                  "position": {
                    "type": "string"
                  },
                  "notes": {
                    "type": "string"
                  },
                  "contactType": {
                    "type": "string"
                  },
                  "source": {
                    "type": "string"
                  }
                },
                "required": [
                  "name"
                ],
                "description": "Данные для создания контакта"
              },
              "example": {
                "firstName": "Иван",
                "lastName": "Петров",
                "middleName": "Сергеевич",
                "email": "ivan.petrov@example.com",
                "phone": "+7 (999) 123-45-67",
                "company": "ООО \"Технологии\"",
                "position": "Технический директор",
                "type": "client",
                "source": "website"
              }
            }
          }
        }
      }
    },
    "/api/contacts/{id}": {
      "get": {
        "summary": "Получить контакт по ID",
        "description": "Возвращает детальную информацию о контакте.",
        "tags": [
          "Контакты"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "name": {
                      "type": "string",
                      "description": "Имя контакта"
                    },
                    "emails": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "address": {
                            "type": "string",
                            "description": "Email адрес",
                            "format": "email"
                          },
                          "isVerified": {
                            "type": "boolean",
                            "default": false
                          },
                          "isSubscribed": {
                            "type": "boolean",
                            "default": true
                          },
                          "unsubscribedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "bouncedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "lastEmailedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        },
                        "required": [
                          "address"
                        ],
                        "description": "Email контакта"
                      },
                      "description": "Список email адресов"
                    },
                    "phones": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "e164": {
                            "type": "string",
                            "description": "Номер в формате E.164 (+71234567890)",
                            "minLength": 1
                          },
                          "international": {
                            "type": "string",
                            "description": "Международный формат (+7 123 456-78-90)",
                            "minLength": 1
                          },
                          "country": {
                            "type": "string",
                            "description": "Код страны ISO 3166-1 alpha-2"
                          },
                          "type": {
                            "type": "string",
                            "enum": [
                              "MOBILE",
                              "FIXED_LINE",
                              "UNKNOWN"
                            ],
                            "description": "Тип телефона",
                            "default": "UNKNOWN"
                          },
                          "isPrimary": {
                            "type": "boolean",
                            "default": false
                          },
                          "isVerified": {
                            "type": "boolean",
                            "default": false
                          },
                          "isSubscribed": {
                            "type": "boolean",
                            "default": true
                          },
                          "unsubscribedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "lastSmsAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        },
                        "required": [
                          "e164",
                          "international",
                          "country"
                        ],
                        "description": "Телефон контакта"
                      },
                      "description": "Список телефонов"
                    },
                    "company": {
                      "type": "string"
                    },
                    "position": {
                      "type": "string"
                    },
                    "notes": {
                      "type": "string"
                    },
                    "contactType": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID типа контакта"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название типа"
                        },
                        "color": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Тип контакта",
                      "nullable": true
                    },
                    "source": {
                      "type": "string"
                    },
                    "ownerId": {
                      "type": "string",
                      "description": "ID владельца"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "name",
                    "emails",
                    "phones",
                    "ownerId",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Контакт"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "firstName": "Иван",
                  "lastName": "Петров",
                  "middleName": "Сергеевич",
                  "email": "ivan.petrov@example.com",
                  "phone": "+7 (999) 123-45-67",
                  "company": "ООО \"Технологии\"",
                  "position": "Технический директор",
                  "type": "client",
                  "source": "website",
                  "ownerId": "clx0987654321fedcba",
                  "createdAt": "2024-01-15T10:30:00.000Z",
                  "updatedAt": "2024-01-15T10:30:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID контакта"
          }
        ]
      },
      "patch": {
        "summary": "Обновить контакт",
        "description": "Частично обновляет данные контакта. Передаются только изменяемые поля.",
        "tags": [
          "Контакты"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "name": {
                      "type": "string",
                      "description": "Имя контакта"
                    },
                    "emails": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "address": {
                            "type": "string",
                            "description": "Email адрес",
                            "format": "email"
                          },
                          "isVerified": {
                            "type": "boolean",
                            "default": false
                          },
                          "isSubscribed": {
                            "type": "boolean",
                            "default": true
                          },
                          "unsubscribedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "bouncedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "lastEmailedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        },
                        "required": [
                          "address"
                        ],
                        "description": "Email контакта"
                      },
                      "description": "Список email адресов"
                    },
                    "phones": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "e164": {
                            "type": "string",
                            "description": "Номер в формате E.164 (+71234567890)",
                            "minLength": 1
                          },
                          "international": {
                            "type": "string",
                            "description": "Международный формат (+7 123 456-78-90)",
                            "minLength": 1
                          },
                          "country": {
                            "type": "string",
                            "description": "Код страны ISO 3166-1 alpha-2"
                          },
                          "type": {
                            "type": "string",
                            "enum": [
                              "MOBILE",
                              "FIXED_LINE",
                              "UNKNOWN"
                            ],
                            "description": "Тип телефона",
                            "default": "UNKNOWN"
                          },
                          "isPrimary": {
                            "type": "boolean",
                            "default": false
                          },
                          "isVerified": {
                            "type": "boolean",
                            "default": false
                          },
                          "isSubscribed": {
                            "type": "boolean",
                            "default": true
                          },
                          "unsubscribedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "lastSmsAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        },
                        "required": [
                          "e164",
                          "international",
                          "country"
                        ],
                        "description": "Телефон контакта"
                      },
                      "description": "Список телефонов"
                    },
                    "company": {
                      "type": "string"
                    },
                    "position": {
                      "type": "string"
                    },
                    "notes": {
                      "type": "string"
                    },
                    "contactType": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID типа контакта"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название типа"
                        },
                        "color": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Тип контакта",
                      "nullable": true
                    },
                    "source": {
                      "type": "string"
                    },
                    "ownerId": {
                      "type": "string",
                      "description": "ID владельца"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "name",
                    "emails",
                    "phones",
                    "ownerId",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Контакт"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "firstName": "Иван",
                  "lastName": "Петров",
                  "middleName": "Сергеевич",
                  "email": "ivan.petrov@example.com",
                  "phone": "+7 (999) 987-65-43",
                  "company": "ООО \"Технологии\"",
                  "position": "Генеральный директор",
                  "type": "client",
                  "source": "website",
                  "ownerId": "clx0987654321fedcba",
                  "createdAt": "2024-01-15T10:30:00.000Z",
                  "updatedAt": "2024-01-15T10:30:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID контакта"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "minLength": 1
                  },
                  "emails": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "address": {
                          "type": "string",
                          "description": "Email адрес",
                          "format": "email"
                        },
                        "isVerified": {
                          "type": "boolean",
                          "default": false
                        },
                        "isSubscribed": {
                          "type": "boolean",
                          "default": true
                        },
                        "unsubscribedAt": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "bouncedAt": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "lastEmailedAt": {
                          "type": "string",
                          "format": "date-time"
                        }
                      },
                      "required": [
                        "address"
                      ],
                      "description": "Email контакта"
                    }
                  },
                  "phones": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "e164": {
                          "type": "string",
                          "description": "Номер в формате E.164 (+71234567890)",
                          "minLength": 1
                        },
                        "international": {
                          "type": "string",
                          "description": "Международный формат (+7 123 456-78-90)",
                          "minLength": 1
                        },
                        "country": {
                          "type": "string",
                          "description": "Код страны ISO 3166-1 alpha-2"
                        },
                        "type": {
                          "type": "string",
                          "enum": [
                            "MOBILE",
                            "FIXED_LINE",
                            "UNKNOWN"
                          ],
                          "description": "Тип телефона",
                          "default": "UNKNOWN"
                        },
                        "isPrimary": {
                          "type": "boolean",
                          "default": false
                        },
                        "isVerified": {
                          "type": "boolean",
                          "default": false
                        },
                        "isSubscribed": {
                          "type": "boolean",
                          "default": true
                        },
                        "unsubscribedAt": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "lastSmsAt": {
                          "type": "string",
                          "format": "date-time"
                        }
                      },
                      "required": [
                        "e164",
                        "international",
                        "country"
                      ],
                      "description": "Телефон контакта"
                    }
                  },
                  "company": {
                    "type": "string"
                  },
                  "position": {
                    "type": "string"
                  },
                  "notes": {
                    "type": "string"
                  },
                  "contactType": {
                    "type": "string",
                    "nullable": true
                  },
                  "source": {
                    "type": "string",
                    "nullable": true
                  }
                },
                "description": "Данные для обновления контакта"
              },
              "example": {
                "phone": "+7 (999) 987-65-43",
                "position": "Генеральный директор"
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Удалить контакт",
        "description": "Полностью удаляет контакт из системы.",
        "tags": [
          "Контакты"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ"
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID контакта"
          }
        ]
      }
    },
    "/api/users/search": {
      "post": {
        "summary": "Поиск пользователей",
        "description": "Возвращает список пользователей с пагинацией. Фильтры передаются в теле запроса. Доступно только администраторам.",
        "tags": [
          "Пользователи"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "users": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Уникальный идентификатор"
                          },
                          "email": {
                            "type": "string",
                            "description": "Email"
                          },
                          "name": {
                            "type": "string",
                            "description": "Имя"
                          },
                          "image": {
                            "type": "string"
                          },
                          "roles": {
                            "type": "array",
                            "items": {
                              "type": "string",
                              "enum": [
                                "admin",
                                "manager",
                                "user"
                              ],
                              "description": "Роль пользователя: admin - администратор, manager - менеджер, user - пользователь"
                            },
                            "description": "Список ролей"
                          },
                          "isActive": {
                            "type": "boolean",
                            "description": "Активен ли пользователь"
                          },
                          "lastLoginAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата создания"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата обновления"
                          }
                        },
                        "required": [
                          "id",
                          "email",
                          "name",
                          "roles",
                          "isActive",
                          "createdAt",
                          "updatedAt"
                        ],
                        "description": "Пользователь"
                      },
                      "description": "Список пользователей"
                    },
                    "total": {
                      "type": "number",
                      "description": "Общее количество"
                    },
                    "page": {
                      "type": "number",
                      "description": "Текущая страница"
                    },
                    "limit": {
                      "type": "number",
                      "description": "Размер страницы"
                    }
                  },
                  "required": [
                    "users",
                    "total",
                    "page",
                    "limit"
                  ],
                  "description": "Список пользователей с пагинацией"
                },
                "example": {
                  "data": [
                    {
                      "id": "clx1234567890abcdef",
                      "email": "admin@example.com",
                      "name": "Администратор Системы",
                      "role": "admin",
                      "isActive": true,
                      "createdAt": "2024-01-10T08:00:00.000Z",
                      "updatedAt": "2024-01-10T08:00:00.000Z"
                    }
                  ],
                  "total": 1,
                  "page": 1,
                  "limit": 20,
                  "totalPages": 1
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "search": {
                    "type": "string"
                  },
                  "role": {
                    "type": "string",
                    "enum": [
                      "admin",
                      "manager",
                      "user"
                    ],
                    "description": "Роль пользователя: admin - администратор, manager - менеджер, user - пользователь"
                  },
                  "isActive": {
                    "type": "boolean"
                  },
                  "page": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 1
                  },
                  "limit": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 100,
                    "default": 20
                  }
                },
                "description": "Фильтры для списка пользователей"
              }
            }
          }
        }
      }
    },
    "/api/users": {
      "post": {
        "summary": "Создать пользователя",
        "description": "Создаёт нового пользователя. Доступно только администраторам.",
        "tags": [
          "Пользователи"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "email": {
                      "type": "string",
                      "description": "Email"
                    },
                    "name": {
                      "type": "string",
                      "description": "Имя"
                    },
                    "image": {
                      "type": "string"
                    },
                    "roles": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "enum": [
                          "admin",
                          "manager",
                          "user"
                        ],
                        "description": "Роль пользователя: admin - администратор, manager - менеджер, user - пользователь"
                      },
                      "description": "Список ролей"
                    },
                    "isActive": {
                      "type": "boolean",
                      "description": "Активен ли пользователь"
                    },
                    "lastLoginAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "email",
                    "name",
                    "roles",
                    "isActive",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Пользователь"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "email": "manager@example.com",
                  "name": "Менеджер Продаж",
                  "role": "manager",
                  "isActive": true,
                  "createdAt": "2024-01-10T08:00:00.000Z",
                  "updatedAt": "2024-01-10T08:00:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "description": "Email пользователя",
                    "format": "email"
                  },
                  "name": {
                    "type": "string",
                    "description": "Имя пользователя",
                    "minLength": 2
                  },
                  "password": {
                    "type": "string",
                    "minLength": 6
                  },
                  "roles": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": [
                        "admin",
                        "manager",
                        "user"
                      ],
                      "description": "Роль пользователя: admin - администратор, manager - менеджер, user - пользователь"
                    }
                  },
                  "googleId": {
                    "type": "string"
                  },
                  "image": {
                    "type": "string",
                    "format": "uri"
                  }
                },
                "required": [
                  "email",
                  "name"
                ],
                "description": "Данные для создания пользователя"
              },
              "example": {
                "email": "manager@example.com",
                "name": "Менеджер Продаж",
                "password": "securePassword123",
                "role": "manager"
              }
            }
          }
        }
      }
    },
    "/api/users/{id}": {
      "get": {
        "summary": "Получить пользователя по ID",
        "description": "Возвращает информацию о пользователе.",
        "tags": [
          "Пользователи"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "email": {
                      "type": "string",
                      "description": "Email"
                    },
                    "name": {
                      "type": "string",
                      "description": "Имя"
                    },
                    "image": {
                      "type": "string"
                    },
                    "roles": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "enum": [
                          "admin",
                          "manager",
                          "user"
                        ],
                        "description": "Роль пользователя: admin - администратор, manager - менеджер, user - пользователь"
                      },
                      "description": "Список ролей"
                    },
                    "isActive": {
                      "type": "boolean",
                      "description": "Активен ли пользователь"
                    },
                    "lastLoginAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "email",
                    "name",
                    "roles",
                    "isActive",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Пользователь"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "email": "admin@example.com",
                  "name": "Администратор Системы",
                  "role": "admin",
                  "isActive": true,
                  "createdAt": "2024-01-10T08:00:00.000Z",
                  "updatedAt": "2024-01-10T08:00:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID пользователя"
          }
        ]
      },
      "patch": {
        "summary": "Обновить пользователя",
        "description": "Обновляет данные пользователя. Доступно только администраторам.",
        "tags": [
          "Пользователи"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "email": {
                      "type": "string",
                      "description": "Email"
                    },
                    "name": {
                      "type": "string",
                      "description": "Имя"
                    },
                    "image": {
                      "type": "string"
                    },
                    "roles": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "enum": [
                          "admin",
                          "manager",
                          "user"
                        ],
                        "description": "Роль пользователя: admin - администратор, manager - менеджер, user - пользователь"
                      },
                      "description": "Список ролей"
                    },
                    "isActive": {
                      "type": "boolean",
                      "description": "Активен ли пользователь"
                    },
                    "lastLoginAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "email",
                    "name",
                    "roles",
                    "isActive",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Пользователь"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "email": "admin@example.com",
                  "name": "Старший менеджер",
                  "role": "admin",
                  "isActive": true,
                  "createdAt": "2024-01-10T08:00:00.000Z",
                  "updatedAt": "2024-01-10T08:00:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID пользователя"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "minLength": 2
                  },
                  "email": {
                    "type": "string",
                    "format": "email"
                  },
                  "roles": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": [
                        "admin",
                        "manager",
                        "user"
                      ],
                      "description": "Роль пользователя: admin - администратор, manager - менеджер, user - пользователь"
                    }
                  },
                  "isActive": {
                    "type": "boolean"
                  },
                  "image": {
                    "type": "string",
                    "format": "uri"
                  }
                },
                "description": "Данные для обновления пользователя"
              },
              "example": {
                "name": "Старший менеджер",
                "role": "admin"
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Удалить пользователя",
        "description": "Удаляет пользователя из системы. Доступно только администраторам.",
        "tags": [
          "Пользователи"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ"
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID пользователя"
          }
        ]
      }
    },
    "/api/opportunities/search": {
      "post": {
        "summary": "Поиск сделок",
        "description": "Возвращает список сделок с пагинацией и фильтрацией. Фильтры передаются в теле запроса.",
        "tags": [
          "Сделки"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "opportunities": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Уникальный идентификатор"
                          },
                          "name": {
                            "type": "string"
                          },
                          "amount": {
                            "type": "number"
                          },
                          "closingDate": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "utm": {
                            "type": "object",
                            "properties": {
                              "source": {
                                "type": "string"
                              },
                              "medium": {
                                "type": "string"
                              },
                              "campaign": {
                                "type": "string"
                              },
                              "term": {
                                "type": "string"
                              },
                              "content": {
                                "type": "string"
                              }
                            },
                            "description": "UTM метки"
                          },
                          "description": {
                            "type": "string"
                          },
                          "externalId": {
                            "type": "string"
                          },
                          "archived": {
                            "type": "boolean",
                            "description": "Архивирована"
                          },
                          "contact": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "description": "ID контакта"
                              },
                              "name": {
                                "type": "string",
                                "description": "Имя контакта"
                              }
                            },
                            "required": [
                              "id",
                              "name"
                            ],
                            "description": "Контакт сделки",
                            "nullable": true
                          },
                          "owner": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "description": "ID владельца"
                              },
                              "name": {
                                "type": "string",
                                "description": "Имя владельца"
                              },
                              "email": {
                                "type": "string",
                                "description": "Email владельца"
                              }
                            },
                            "required": [
                              "id",
                              "name",
                              "email"
                            ],
                            "description": "Владелец сделки",
                            "nullable": true
                          },
                          "priority": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "description": "ID приоритета"
                              },
                              "name": {
                                "type": "string",
                                "description": "Название"
                              },
                              "color": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "id",
                              "name"
                            ],
                            "description": "Приоритет сделки",
                            "nullable": true
                          },
                          "pipeline": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "description": "ID воронки"
                              },
                              "name": {
                                "type": "string",
                                "description": "Название воронки"
                              },
                              "code": {
                                "type": "string",
                                "description": "Код воронки"
                              }
                            },
                            "required": [
                              "id",
                              "name",
                              "code"
                            ],
                            "description": "Воронка сделки",
                            "nullable": true
                          },
                          "stage": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "description": "ID этапа"
                              },
                              "name": {
                                "type": "string",
                                "description": "Название этапа"
                              },
                              "color": {
                                "type": "string",
                                "description": "Цвет"
                              },
                              "order": {
                                "type": "number",
                                "description": "Порядок"
                              },
                              "probability": {
                                "type": "number",
                                "description": "Вероятность закрытия"
                              },
                              "isInitial": {
                                "type": "boolean",
                                "description": "Начальный этап"
                              },
                              "isFinal": {
                                "type": "boolean",
                                "description": "Финальный этап"
                              },
                              "isWon": {
                                "type": "boolean",
                                "description": "Успешное закрытие"
                              }
                            },
                            "required": [
                              "id",
                              "name",
                              "color",
                              "order",
                              "probability",
                              "isInitial",
                              "isFinal",
                              "isWon"
                            ],
                            "description": "Этап воронки",
                            "nullable": true
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата создания"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата обновления"
                          }
                        },
                        "required": [
                          "id",
                          "archived",
                          "createdAt",
                          "updatedAt"
                        ],
                        "description": "Сделка"
                      },
                      "description": "Список сделок"
                    },
                    "total": {
                      "type": "number",
                      "description": "Общее количество"
                    },
                    "page": {
                      "type": "number",
                      "description": "Текущая страница"
                    },
                    "limit": {
                      "type": "number",
                      "description": "Размер страницы"
                    }
                  },
                  "required": [
                    "opportunities",
                    "total",
                    "page",
                    "limit"
                  ],
                  "description": "Список сделок с пагинацией"
                },
                "example": {
                  "opportunities": [
                    {
                      "id": "clx1234567890abcdef",
                      "name": "Внедрение CRM системы",
                      "description": "Проект по внедрению CRM для автоматизации продаж",
                      "amount": 1500000,
                      "closingDate": "2024-03-15",
                      "archived": false,
                      "externalId": "EXT-001",
                      "utm": {
                        "source": "google",
                        "medium": "cpc",
                        "campaign": "spring_sale"
                      },
                      "contact": {
                        "id": "clx0987654321fedcba",
                        "name": "Иван Петров"
                      },
                      "owner": {
                        "id": "clxowner123456789ab",
                        "name": "Менеджер",
                        "email": "manager@example.com"
                      },
                      "priority": {
                        "id": "clxpriority123",
                        "name": "Высокий",
                        "color": "#f97316"
                      },
                      "createdAt": "2024-01-20T14:00:00.000Z",
                      "updatedAt": "2024-02-01T09:30:00.000Z"
                    }
                  ],
                  "total": 1,
                  "page": 1,
                  "limit": 20
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "search": {
                    "type": "string"
                  },
                  "archived": {
                    "type": "boolean"
                  },
                  "ownerId": {
                    "type": "string"
                  },
                  "contactId": {
                    "type": "string"
                  },
                  "priorityId": {
                    "type": "string"
                  },
                  "pipelineId": {
                    "type": "string"
                  },
                  "stageId": {
                    "type": "string"
                  },
                  "minAmount": {
                    "type": "number"
                  },
                  "maxAmount": {
                    "type": "number"
                  },
                  "closingDateFrom": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "closingDateTo": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "page": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 1
                  },
                  "limit": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 100,
                    "default": 20
                  }
                },
                "description": "Фильтры для списка сделок"
              }
            }
          }
        }
      }
    },
    "/api/opportunities": {
      "post": {
        "summary": "Создать сделку",
        "description": "Создаёт новую сделку. Владельцем автоматически становится текущий пользователь.",
        "tags": [
          "Сделки"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "name": {
                      "type": "string"
                    },
                    "amount": {
                      "type": "number"
                    },
                    "closingDate": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "utm": {
                      "type": "object",
                      "properties": {
                        "source": {
                          "type": "string"
                        },
                        "medium": {
                          "type": "string"
                        },
                        "campaign": {
                          "type": "string"
                        },
                        "term": {
                          "type": "string"
                        },
                        "content": {
                          "type": "string"
                        }
                      },
                      "description": "UTM метки"
                    },
                    "description": {
                      "type": "string"
                    },
                    "externalId": {
                      "type": "string"
                    },
                    "archived": {
                      "type": "boolean",
                      "description": "Архивирована"
                    },
                    "contact": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID контакта"
                        },
                        "name": {
                          "type": "string",
                          "description": "Имя контакта"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Контакт сделки",
                      "nullable": true
                    },
                    "owner": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID владельца"
                        },
                        "name": {
                          "type": "string",
                          "description": "Имя владельца"
                        },
                        "email": {
                          "type": "string",
                          "description": "Email владельца"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "email"
                      ],
                      "description": "Владелец сделки",
                      "nullable": true
                    },
                    "priority": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID приоритета"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название"
                        },
                        "color": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Приоритет сделки",
                      "nullable": true
                    },
                    "pipeline": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID воронки"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название воронки"
                        },
                        "code": {
                          "type": "string",
                          "description": "Код воронки"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "code"
                      ],
                      "description": "Воронка сделки",
                      "nullable": true
                    },
                    "stage": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID этапа"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название этапа"
                        },
                        "color": {
                          "type": "string",
                          "description": "Цвет"
                        },
                        "order": {
                          "type": "number",
                          "description": "Порядок"
                        },
                        "probability": {
                          "type": "number",
                          "description": "Вероятность закрытия"
                        },
                        "isInitial": {
                          "type": "boolean",
                          "description": "Начальный этап"
                        },
                        "isFinal": {
                          "type": "boolean",
                          "description": "Финальный этап"
                        },
                        "isWon": {
                          "type": "boolean",
                          "description": "Успешное закрытие"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "color",
                        "order",
                        "probability",
                        "isInitial",
                        "isFinal",
                        "isWon"
                      ],
                      "description": "Этап воронки",
                      "nullable": true
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "archived",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Сделка"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "name": "Внедрение CRM системы",
                  "description": "Проект по внедрению CRM для автоматизации продаж",
                  "amount": 1500000,
                  "closingDate": "2024-03-15",
                  "archived": false,
                  "externalId": "EXT-001",
                  "utm": {
                    "source": "google",
                    "medium": "cpc",
                    "campaign": "spring_sale"
                  },
                  "contact": {
                    "id": "clx0987654321fedcba",
                    "name": "Иван Петров"
                  },
                  "owner": {
                    "id": "clxowner123456789ab",
                    "name": "Менеджер",
                    "email": "manager@example.com"
                  },
                  "priority": {
                    "id": "clxpriority123",
                    "name": "Высокий",
                    "color": "#f97316"
                  },
                  "createdAt": "2024-01-20T14:00:00.000Z",
                  "updatedAt": "2024-02-01T09:30:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "amount": {
                    "type": "number",
                    "minimum": 0
                  },
                  "closingDate": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "utm": {
                    "type": "object",
                    "properties": {
                      "source": {
                        "type": "string"
                      },
                      "medium": {
                        "type": "string"
                      },
                      "campaign": {
                        "type": "string"
                      },
                      "term": {
                        "type": "string"
                      },
                      "content": {
                        "type": "string"
                      }
                    },
                    "description": "UTM метки"
                  },
                  "description": {
                    "type": "string"
                  },
                  "externalId": {
                    "type": "string"
                  },
                  "archived": {
                    "type": "boolean",
                    "default": false
                  },
                  "contactId": {
                    "type": "string"
                  },
                  "ownerId": {
                    "type": "string"
                  },
                  "priorityId": {
                    "type": "string"
                  },
                  "pipelineId": {
                    "type": "string"
                  },
                  "stageId": {
                    "type": "string"
                  }
                },
                "description": "Данные для создания сделки"
              },
              "example": {
                "name": "Внедрение CRM системы",
                "description": "Проект по внедрению CRM для автоматизации продаж",
                "amount": 1500000,
                "closingDate": "2024-03-15",
                "contactId": "clx0987654321fedcba",
                "priorityId": "clxpriority123"
              }
            }
          }
        }
      }
    },
    "/api/opportunities/{id}": {
      "get": {
        "summary": "Получить сделку по ID",
        "description": "Возвращает детальную информацию о сделке.",
        "tags": [
          "Сделки"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "name": {
                      "type": "string"
                    },
                    "amount": {
                      "type": "number"
                    },
                    "closingDate": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "utm": {
                      "type": "object",
                      "properties": {
                        "source": {
                          "type": "string"
                        },
                        "medium": {
                          "type": "string"
                        },
                        "campaign": {
                          "type": "string"
                        },
                        "term": {
                          "type": "string"
                        },
                        "content": {
                          "type": "string"
                        }
                      },
                      "description": "UTM метки"
                    },
                    "description": {
                      "type": "string"
                    },
                    "externalId": {
                      "type": "string"
                    },
                    "archived": {
                      "type": "boolean",
                      "description": "Архивирована"
                    },
                    "contact": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID контакта"
                        },
                        "name": {
                          "type": "string",
                          "description": "Имя контакта"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Контакт сделки",
                      "nullable": true
                    },
                    "owner": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID владельца"
                        },
                        "name": {
                          "type": "string",
                          "description": "Имя владельца"
                        },
                        "email": {
                          "type": "string",
                          "description": "Email владельца"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "email"
                      ],
                      "description": "Владелец сделки",
                      "nullable": true
                    },
                    "priority": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID приоритета"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название"
                        },
                        "color": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Приоритет сделки",
                      "nullable": true
                    },
                    "pipeline": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID воронки"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название воронки"
                        },
                        "code": {
                          "type": "string",
                          "description": "Код воронки"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "code"
                      ],
                      "description": "Воронка сделки",
                      "nullable": true
                    },
                    "stage": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID этапа"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название этапа"
                        },
                        "color": {
                          "type": "string",
                          "description": "Цвет"
                        },
                        "order": {
                          "type": "number",
                          "description": "Порядок"
                        },
                        "probability": {
                          "type": "number",
                          "description": "Вероятность закрытия"
                        },
                        "isInitial": {
                          "type": "boolean",
                          "description": "Начальный этап"
                        },
                        "isFinal": {
                          "type": "boolean",
                          "description": "Финальный этап"
                        },
                        "isWon": {
                          "type": "boolean",
                          "description": "Успешное закрытие"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "color",
                        "order",
                        "probability",
                        "isInitial",
                        "isFinal",
                        "isWon"
                      ],
                      "description": "Этап воронки",
                      "nullable": true
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "archived",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Сделка"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "name": "Внедрение CRM системы",
                  "description": "Проект по внедрению CRM для автоматизации продаж",
                  "amount": 1500000,
                  "closingDate": "2024-03-15",
                  "archived": false,
                  "externalId": "EXT-001",
                  "utm": {
                    "source": "google",
                    "medium": "cpc",
                    "campaign": "spring_sale"
                  },
                  "contact": {
                    "id": "clx0987654321fedcba",
                    "name": "Иван Петров"
                  },
                  "owner": {
                    "id": "clxowner123456789ab",
                    "name": "Менеджер",
                    "email": "manager@example.com"
                  },
                  "priority": {
                    "id": "clxpriority123",
                    "name": "Высокий",
                    "color": "#f97316"
                  },
                  "createdAt": "2024-01-20T14:00:00.000Z",
                  "updatedAt": "2024-02-01T09:30:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID сделки"
          }
        ]
      },
      "patch": {
        "summary": "Обновить сделку",
        "description": "Частично обновляет данные сделки.",
        "tags": [
          "Сделки"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "name": {
                      "type": "string"
                    },
                    "amount": {
                      "type": "number"
                    },
                    "closingDate": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "utm": {
                      "type": "object",
                      "properties": {
                        "source": {
                          "type": "string"
                        },
                        "medium": {
                          "type": "string"
                        },
                        "campaign": {
                          "type": "string"
                        },
                        "term": {
                          "type": "string"
                        },
                        "content": {
                          "type": "string"
                        }
                      },
                      "description": "UTM метки"
                    },
                    "description": {
                      "type": "string"
                    },
                    "externalId": {
                      "type": "string"
                    },
                    "archived": {
                      "type": "boolean",
                      "description": "Архивирована"
                    },
                    "contact": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID контакта"
                        },
                        "name": {
                          "type": "string",
                          "description": "Имя контакта"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Контакт сделки",
                      "nullable": true
                    },
                    "owner": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID владельца"
                        },
                        "name": {
                          "type": "string",
                          "description": "Имя владельца"
                        },
                        "email": {
                          "type": "string",
                          "description": "Email владельца"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "email"
                      ],
                      "description": "Владелец сделки",
                      "nullable": true
                    },
                    "priority": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID приоритета"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название"
                        },
                        "color": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Приоритет сделки",
                      "nullable": true
                    },
                    "pipeline": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID воронки"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название воронки"
                        },
                        "code": {
                          "type": "string",
                          "description": "Код воронки"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "code"
                      ],
                      "description": "Воронка сделки",
                      "nullable": true
                    },
                    "stage": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "ID этапа"
                        },
                        "name": {
                          "type": "string",
                          "description": "Название этапа"
                        },
                        "color": {
                          "type": "string",
                          "description": "Цвет"
                        },
                        "order": {
                          "type": "number",
                          "description": "Порядок"
                        },
                        "probability": {
                          "type": "number",
                          "description": "Вероятность закрытия"
                        },
                        "isInitial": {
                          "type": "boolean",
                          "description": "Начальный этап"
                        },
                        "isFinal": {
                          "type": "boolean",
                          "description": "Финальный этап"
                        },
                        "isWon": {
                          "type": "boolean",
                          "description": "Успешное закрытие"
                        }
                      },
                      "required": [
                        "id",
                        "name",
                        "color",
                        "order",
                        "probability",
                        "isInitial",
                        "isFinal",
                        "isWon"
                      ],
                      "description": "Этап воронки",
                      "nullable": true
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "archived",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Сделка"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "name": "Обновлённое название",
                  "description": "Проект по внедрению CRM для автоматизации продаж",
                  "amount": 1800000,
                  "closingDate": "2024-03-15",
                  "archived": false,
                  "externalId": "EXT-001",
                  "utm": {
                    "source": "google",
                    "medium": "cpc",
                    "campaign": "spring_sale"
                  },
                  "contact": {
                    "id": "clx0987654321fedcba",
                    "name": "Иван Петров"
                  },
                  "owner": {
                    "id": "clxowner123456789ab",
                    "name": "Менеджер",
                    "email": "manager@example.com"
                  },
                  "priority": {
                    "id": "clxpriority123",
                    "name": "Высокий",
                    "color": "#f97316"
                  },
                  "createdAt": "2024-01-20T14:00:00.000Z",
                  "updatedAt": "2024-02-01T09:30:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID сделки"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "nullable": true
                  },
                  "amount": {
                    "type": "number",
                    "minimum": 0,
                    "nullable": true
                  },
                  "closingDate": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true
                  },
                  "utm": {
                    "type": "object",
                    "properties": {
                      "source": {
                        "type": "string"
                      },
                      "medium": {
                        "type": "string"
                      },
                      "campaign": {
                        "type": "string"
                      },
                      "term": {
                        "type": "string"
                      },
                      "content": {
                        "type": "string"
                      }
                    },
                    "description": "UTM метки",
                    "nullable": true
                  },
                  "description": {
                    "type": "string",
                    "nullable": true
                  },
                  "externalId": {
                    "type": "string",
                    "nullable": true
                  },
                  "archived": {
                    "type": "boolean"
                  },
                  "contactId": {
                    "type": "string",
                    "nullable": true
                  },
                  "ownerId": {
                    "type": "string",
                    "nullable": true
                  },
                  "priorityId": {
                    "type": "string",
                    "nullable": true
                  },
                  "pipelineId": {
                    "type": "string",
                    "nullable": true
                  },
                  "stageId": {
                    "type": "string",
                    "nullable": true
                  }
                },
                "description": "Данные для обновления сделки"
              },
              "example": {
                "name": "Обновлённое название",
                "amount": 1800000
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Удалить сделку",
        "description": "Удаляет сделку из системы.",
        "tags": [
          "Сделки"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ"
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID сделки"
          }
        ]
      }
    },
    "/api/dictionaries/search": {
      "post": {
        "summary": "Поиск словарей",
        "description": "Возвращает список всех словарей с количеством элементов в каждом.",
        "tags": [
          "Словари"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "dictionaries": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Уникальный идентификатор"
                          },
                          "code": {
                            "type": "string",
                            "description": "Код словаря"
                          },
                          "name": {
                            "type": "string",
                            "description": "Название"
                          },
                          "description": {
                            "type": "string"
                          },
                          "allowHierarchy": {
                            "type": "boolean",
                            "description": "Разрешена ли иерархия"
                          },
                          "maxDepth": {
                            "type": "number",
                            "description": "Максимальная глубина"
                          },
                          "fields": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "code": {
                                  "type": "string",
                                  "description": "Уникальный код поля",
                                  "minLength": 1,
                                  "pattern": "^[a-z][a-z0-9_]*$"
                                },
                                "name": {
                                  "type": "string",
                                  "description": "Отображаемое название",
                                  "minLength": 1
                                },
                                "type": {
                                  "type": "string",
                                  "enum": [
                                    "string",
                                    "number",
                                    "boolean",
                                    "color",
                                    "icon"
                                  ],
                                  "description": "Тип поля"
                                },
                                "required": {
                                  "type": "boolean",
                                  "default": false
                                }
                              },
                              "required": [
                                "code",
                                "name",
                                "type"
                              ],
                              "description": "Дополнительное поле словаря"
                            },
                            "description": "Дополнительные поля"
                          },
                          "itemCount": {
                            "type": "number"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата создания"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата обновления"
                          }
                        },
                        "required": [
                          "id",
                          "code",
                          "name",
                          "allowHierarchy",
                          "maxDepth",
                          "fields",
                          "createdAt",
                          "updatedAt"
                        ],
                        "description": "Словарь"
                      },
                      "description": "Список словарей"
                    },
                    "total": {
                      "type": "number",
                      "description": "Общее количество"
                    }
                  },
                  "required": [
                    "dictionaries",
                    "total"
                  ],
                  "description": "Список словарей"
                },
                "example": [
                  {
                    "id": "clx1234567890abcdef",
                    "code": "contact_types",
                    "name": "Типы контактов",
                    "description": "Словарь типов контактов для классификации",
                    "isSystem": false,
                    "isHierarchical": false,
                    "createdAt": "2024-01-05T12:00:00.000Z",
                    "updatedAt": "2024-01-05T12:00:00.000Z",
                    "_count": {
                      "items": 5
                    }
                  }
                ]
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/dictionaries": {
      "post": {
        "summary": "Создать словарь",
        "description": "Создаёт новый словарь с указанными полями.",
        "tags": [
          "Словари"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "code": {
                      "type": "string",
                      "description": "Код словаря"
                    },
                    "name": {
                      "type": "string",
                      "description": "Название"
                    },
                    "description": {
                      "type": "string"
                    },
                    "allowHierarchy": {
                      "type": "boolean",
                      "description": "Разрешена ли иерархия"
                    },
                    "maxDepth": {
                      "type": "number",
                      "description": "Максимальная глубина"
                    },
                    "fields": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "code": {
                            "type": "string",
                            "description": "Уникальный код поля",
                            "minLength": 1,
                            "pattern": "^[a-z][a-z0-9_]*$"
                          },
                          "name": {
                            "type": "string",
                            "description": "Отображаемое название",
                            "minLength": 1
                          },
                          "type": {
                            "type": "string",
                            "enum": [
                              "string",
                              "number",
                              "boolean",
                              "color",
                              "icon"
                            ],
                            "description": "Тип поля"
                          },
                          "required": {
                            "type": "boolean",
                            "default": false
                          }
                        },
                        "required": [
                          "code",
                          "name",
                          "type"
                        ],
                        "description": "Дополнительное поле словаря"
                      },
                      "description": "Дополнительные поля"
                    },
                    "itemCount": {
                      "type": "number"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "code",
                    "name",
                    "allowHierarchy",
                    "maxDepth",
                    "fields",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Словарь"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "code": "industries",
                  "name": "Отрасли",
                  "description": "Отрасли экономики для классификации клиентов",
                  "isSystem": false,
                  "isHierarchical": true,
                  "createdAt": "2024-01-05T12:00:00.000Z",
                  "updatedAt": "2024-01-05T12:00:00.000Z",
                  "_count": {
                    "items": 0
                  }
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "code": {
                    "type": "string",
                    "description": "Уникальный код словаря",
                    "minLength": 1,
                    "maxLength": 50,
                    "pattern": "^[a-z][a-z0-9_]*$"
                  },
                  "name": {
                    "type": "string",
                    "description": "Название словаря",
                    "minLength": 1,
                    "maxLength": 100
                  },
                  "description": {
                    "type": "string",
                    "maxLength": 500
                  },
                  "allowHierarchy": {
                    "type": "boolean",
                    "default": false
                  },
                  "maxDepth": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 3,
                    "default": 1
                  },
                  "fields": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "code": {
                          "type": "string",
                          "description": "Уникальный код поля",
                          "minLength": 1,
                          "pattern": "^[a-z][a-z0-9_]*$"
                        },
                        "name": {
                          "type": "string",
                          "description": "Отображаемое название",
                          "minLength": 1
                        },
                        "type": {
                          "type": "string",
                          "enum": [
                            "string",
                            "number",
                            "boolean",
                            "color",
                            "icon"
                          ],
                          "description": "Тип поля"
                        },
                        "required": {
                          "type": "boolean",
                          "default": false
                        }
                      },
                      "required": [
                        "code",
                        "name",
                        "type"
                      ],
                      "description": "Дополнительное поле словаря"
                    },
                    "default": []
                  }
                },
                "required": [
                  "code",
                  "name"
                ],
                "description": "Данные для создания словаря"
              },
              "example": {
                "code": "industries",
                "name": "Отрасли",
                "description": "Отрасли экономики для классификации клиентов",
                "isHierarchical": true
              }
            }
          }
        }
      }
    },
    "/api/dictionaries/{code}": {
      "get": {
        "summary": "Получить словарь по коду",
        "description": "Возвращает информацию о словаре.",
        "tags": [
          "Словари"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "code": {
                      "type": "string",
                      "description": "Код словаря"
                    },
                    "name": {
                      "type": "string",
                      "description": "Название"
                    },
                    "description": {
                      "type": "string"
                    },
                    "allowHierarchy": {
                      "type": "boolean",
                      "description": "Разрешена ли иерархия"
                    },
                    "maxDepth": {
                      "type": "number",
                      "description": "Максимальная глубина"
                    },
                    "fields": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "code": {
                            "type": "string",
                            "description": "Уникальный код поля",
                            "minLength": 1,
                            "pattern": "^[a-z][a-z0-9_]*$"
                          },
                          "name": {
                            "type": "string",
                            "description": "Отображаемое название",
                            "minLength": 1
                          },
                          "type": {
                            "type": "string",
                            "enum": [
                              "string",
                              "number",
                              "boolean",
                              "color",
                              "icon"
                            ],
                            "description": "Тип поля"
                          },
                          "required": {
                            "type": "boolean",
                            "default": false
                          }
                        },
                        "required": [
                          "code",
                          "name",
                          "type"
                        ],
                        "description": "Дополнительное поле словаря"
                      },
                      "description": "Дополнительные поля"
                    },
                    "itemCount": {
                      "type": "number"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "code",
                    "name",
                    "allowHierarchy",
                    "maxDepth",
                    "fields",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Словарь"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "code": "contact_types",
                  "name": "Типы контактов",
                  "description": "Словарь типов контактов для классификации",
                  "isSystem": false,
                  "isHierarchical": false,
                  "createdAt": "2024-01-05T12:00:00.000Z",
                  "updatedAt": "2024-01-05T12:00:00.000Z",
                  "_count": {
                    "items": 5
                  }
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Код словаря"
          }
        ]
      },
      "patch": {
        "summary": "Обновить словарь",
        "description": "Обновляет настройки словаря.",
        "tags": [
          "Словари"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "code": {
                      "type": "string",
                      "description": "Код словаря"
                    },
                    "name": {
                      "type": "string",
                      "description": "Название"
                    },
                    "description": {
                      "type": "string"
                    },
                    "allowHierarchy": {
                      "type": "boolean",
                      "description": "Разрешена ли иерархия"
                    },
                    "maxDepth": {
                      "type": "number",
                      "description": "Максимальная глубина"
                    },
                    "fields": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "code": {
                            "type": "string",
                            "description": "Уникальный код поля",
                            "minLength": 1,
                            "pattern": "^[a-z][a-z0-9_]*$"
                          },
                          "name": {
                            "type": "string",
                            "description": "Отображаемое название",
                            "minLength": 1
                          },
                          "type": {
                            "type": "string",
                            "enum": [
                              "string",
                              "number",
                              "boolean",
                              "color",
                              "icon"
                            ],
                            "description": "Тип поля"
                          },
                          "required": {
                            "type": "boolean",
                            "default": false
                          }
                        },
                        "required": [
                          "code",
                          "name",
                          "type"
                        ],
                        "description": "Дополнительное поле словаря"
                      },
                      "description": "Дополнительные поля"
                    },
                    "itemCount": {
                      "type": "number"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "code",
                    "name",
                    "allowHierarchy",
                    "maxDepth",
                    "fields",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Словарь"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "code": "contact_types",
                  "name": "Отрасли экономики",
                  "description": "Обновлённое описание отраслей",
                  "isSystem": false,
                  "isHierarchical": false,
                  "createdAt": "2024-01-05T12:00:00.000Z",
                  "updatedAt": "2024-01-05T12:00:00.000Z",
                  "_count": {
                    "items": 5
                  }
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Код словаря"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 100
                  },
                  "description": {
                    "type": "string",
                    "maxLength": 500
                  },
                  "allowHierarchy": {
                    "type": "boolean"
                  },
                  "maxDepth": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 3
                  },
                  "fields": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "code": {
                          "type": "string",
                          "description": "Уникальный код поля",
                          "minLength": 1,
                          "pattern": "^[a-z][a-z0-9_]*$"
                        },
                        "name": {
                          "type": "string",
                          "description": "Отображаемое название",
                          "minLength": 1
                        },
                        "type": {
                          "type": "string",
                          "enum": [
                            "string",
                            "number",
                            "boolean",
                            "color",
                            "icon"
                          ],
                          "description": "Тип поля"
                        },
                        "required": {
                          "type": "boolean",
                          "default": false
                        }
                      },
                      "required": [
                        "code",
                        "name",
                        "type"
                      ],
                      "description": "Дополнительное поле словаря"
                    }
                  }
                },
                "description": "Данные для обновления словаря"
              },
              "example": {
                "name": "Отрасли экономики",
                "description": "Обновлённое описание отраслей"
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Удалить словарь",
        "description": "Удаляет словарь вместе со всеми его элементами.",
        "tags": [
          "Словари"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ"
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Код словаря"
          }
        ]
      }
    },
    "/api/dictionaries/{code}/items": {
      "get": {
        "summary": "Получить элементы словаря",
        "description": "Возвращает список элементов словаря. По умолчанию только активные.",
        "tags": [
          "Элементы словаря"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "items": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Уникальный идентификатор"
                          },
                          "dictionaryCode": {
                            "type": "string",
                            "description": "Код словаря"
                          },
                          "code": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string",
                            "description": "Название"
                          },
                          "weight": {
                            "type": "number",
                            "description": "Порядковый номер"
                          },
                          "parentId": {
                            "type": "string",
                            "nullable": true
                          },
                          "depth": {
                            "type": "number",
                            "description": "Уровень вложенности"
                          },
                          "isActive": {
                            "type": "boolean",
                            "description": "Активен ли элемент"
                          },
                          "properties": {
                            "type": "object",
                            "additionalProperties": {},
                            "description": "Дополнительные свойства"
                          },
                          "children": {
                            "type": "array",
                            "items": {
                              "type": "array",
                              "items": {
                                "type": "object"
                              },
                              "description": "Рекурсивная структура"
                            }
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата создания"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата обновления"
                          }
                        },
                        "required": [
                          "id",
                          "dictionaryCode",
                          "name",
                          "weight",
                          "parentId",
                          "depth",
                          "isActive",
                          "properties",
                          "createdAt",
                          "updatedAt"
                        ],
                        "description": "Элемент словаря"
                      },
                      "description": "Список элементов"
                    },
                    "total": {
                      "type": "number",
                      "description": "Общее количество"
                    }
                  },
                  "required": [
                    "items",
                    "total"
                  ],
                  "description": "Список элементов словаря"
                },
                "example": [
                  {
                    "id": "clxitem12345678abcd",
                    "code": "client",
                    "name": "Клиент",
                    "description": "Действующий клиент компании",
                    "sortOrder": 1,
                    "isActive": true,
                    "parentId": null,
                    "dictionaryCode": "contact_types",
                    "children": []
                  }
                ]
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Код словаря"
          },
          {
            "name": "includeInactive",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean"
            },
            "description": "Включить неактивные элементы"
          }
        ]
      },
      "post": {
        "summary": "Создать элемент словаря",
        "description": "Добавляет новый элемент в словарь.",
        "tags": [
          "Элементы словаря"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "dictionaryCode": {
                      "type": "string",
                      "description": "Код словаря"
                    },
                    "code": {
                      "type": "string"
                    },
                    "name": {
                      "type": "string",
                      "description": "Название"
                    },
                    "weight": {
                      "type": "number",
                      "description": "Порядковый номер"
                    },
                    "parentId": {
                      "type": "string",
                      "nullable": true
                    },
                    "depth": {
                      "type": "number",
                      "description": "Уровень вложенности"
                    },
                    "isActive": {
                      "type": "boolean",
                      "description": "Активен ли элемент"
                    },
                    "properties": {
                      "type": "object",
                      "additionalProperties": {},
                      "description": "Дополнительные свойства"
                    },
                    "children": {
                      "type": "array",
                      "items": {
                        "type": "array",
                        "items": {
                          "type": "object"
                        },
                        "description": "Рекурсивная структура"
                      }
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "dictionaryCode",
                    "name",
                    "weight",
                    "parentId",
                    "depth",
                    "isActive",
                    "properties",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Элемент словаря"
                },
                "example": {
                  "id": "clxitem12345678abcd",
                  "code": "partner",
                  "name": "Партнёр",
                  "description": "Партнёр компании",
                  "sortOrder": 2,
                  "isActive": true,
                  "parentId": null,
                  "dictionaryCode": "contact_types",
                  "children": []
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Код словаря"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "code": {
                    "type": "string",
                    "maxLength": 50,
                    "pattern": "^[a-z][a-z0-9_]*$"
                  },
                  "name": {
                    "type": "string",
                    "description": "Название элемента",
                    "minLength": 1,
                    "maxLength": 100
                  },
                  "parentId": {
                    "type": "string",
                    "nullable": true,
                    "default": null
                  },
                  "properties": {
                    "type": "object",
                    "additionalProperties": {},
                    "default": {}
                  }
                },
                "required": [
                  "name"
                ],
                "description": "Данные для создания элемента словаря"
              },
              "example": {
                "code": "partner",
                "name": "Партнёр",
                "description": "Партнёр компании",
                "sortOrder": 2,
                "isActive": true
              }
            }
          }
        }
      }
    },
    "/api/dictionaries/{code}/items/{id}": {
      "patch": {
        "summary": "Обновить элемент словаря",
        "description": "Обновляет данные элемента.",
        "tags": [
          "Элементы словаря"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "dictionaryCode": {
                      "type": "string",
                      "description": "Код словаря"
                    },
                    "code": {
                      "type": "string"
                    },
                    "name": {
                      "type": "string",
                      "description": "Название"
                    },
                    "weight": {
                      "type": "number",
                      "description": "Порядковый номер"
                    },
                    "parentId": {
                      "type": "string",
                      "nullable": true
                    },
                    "depth": {
                      "type": "number",
                      "description": "Уровень вложенности"
                    },
                    "isActive": {
                      "type": "boolean",
                      "description": "Активен ли элемент"
                    },
                    "properties": {
                      "type": "object",
                      "additionalProperties": {},
                      "description": "Дополнительные свойства"
                    },
                    "children": {
                      "type": "array",
                      "items": {
                        "type": "array",
                        "items": {
                          "type": "object"
                        },
                        "description": "Рекурсивная структура"
                      }
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "dictionaryCode",
                    "name",
                    "weight",
                    "parentId",
                    "depth",
                    "isActive",
                    "properties",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Элемент словаря"
                },
                "example": {
                  "id": "clxitem12345678abcd",
                  "code": "client",
                  "name": "Стратегический партнёр",
                  "description": "Действующий клиент компании",
                  "sortOrder": 1,
                  "isActive": true,
                  "parentId": null,
                  "dictionaryCode": "contact_types",
                  "children": []
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Код словаря"
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID элемента"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "code": {
                    "type": "string",
                    "maxLength": 50,
                    "pattern": "^[a-z][a-z0-9_]*$",
                    "nullable": true
                  },
                  "name": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 100
                  },
                  "parentId": {
                    "type": "string",
                    "nullable": true
                  },
                  "isActive": {
                    "type": "boolean"
                  },
                  "properties": {
                    "type": "object",
                    "additionalProperties": {}
                  }
                },
                "description": "Данные для обновления элемента словаря"
              },
              "example": {
                "name": "Стратегический партнёр",
                "sortOrder": 1
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Удалить элемент словаря",
        "description": "Удаляет элемент. Дочерние элементы переносятся к родителю удаляемого элемента.",
        "tags": [
          "Элементы словаря"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ"
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Код словаря"
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID элемента"
          }
        ]
      }
    },
    "/api/interactions/search": {
      "post": {
        "summary": "Поиск взаимодействий",
        "description": "Возвращает список взаимодействий с пагинацией и фильтрацией.\n\n**Фильтры:**\n- `contactId` — фильтр по контакту\n- `channelId` — фильтр по каналу\n- `opportunityId` — фильтр по сделке\n- `direction` — направление (inbound/outbound)\n- `status` — статус (pending/sent/delivered/read/failed)\n- `dateFrom`, `dateTo` — диапазон дат\n\n**Пагинация:**\n- `limit` — количество записей (по умолчанию 50, макс. 100)\n- `offset` — смещение",
        "tags": [
          "Взаимодействия"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "interactions": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Уникальный идентификатор"
                          },
                          "channelId": {
                            "type": "string",
                            "description": "ID канала"
                          },
                          "contactId": {
                            "type": "string",
                            "description": "ID контакта"
                          },
                          "opportunityId": {
                            "type": "string"
                          },
                          "direction": {
                            "type": "string",
                            "enum": [
                              "inbound",
                              "outbound"
                            ],
                            "description": "Направление"
                          },
                          "status": {
                            "type": "string",
                            "enum": [
                              "pending",
                              "sent",
                              "delivered",
                              "read",
                              "failed"
                            ],
                            "description": "Статус"
                          },
                          "subject": {
                            "type": "string"
                          },
                          "content": {
                            "type": "string",
                            "description": "Содержимое"
                          },
                          "duration": {
                            "type": "number"
                          },
                          "recordingUrl": {
                            "type": "string"
                          },
                          "metadata": {
                            "type": "object",
                            "additionalProperties": {},
                            "description": "Метаданные"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата создания"
                          },
                          "createdBy": {
                            "type": "string"
                          },
                          "channel": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "code": {
                                "type": "string"
                              },
                              "name": {
                                "type": "string"
                              },
                              "icon": {
                                "type": "string"
                              },
                              "color": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "id",
                              "code",
                              "name",
                              "icon",
                              "color"
                            ],
                            "description": "Канал (embedded)"
                          },
                          "contact": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "name": {
                                "type": "string"
                              }
                            },
                            "required": [
                              "id",
                              "name"
                            ],
                            "description": "Контакт (embedded)"
                          }
                        },
                        "required": [
                          "id",
                          "channelId",
                          "contactId",
                          "direction",
                          "status",
                          "content",
                          "metadata",
                          "createdAt"
                        ],
                        "description": "Взаимодействие"
                      },
                      "description": "Список взаимодействий"
                    },
                    "total": {
                      "type": "number",
                      "description": "Общее количество"
                    }
                  },
                  "required": [
                    "interactions",
                    "total"
                  ],
                  "description": "Список взаимодействий"
                },
                "example": {
                  "interactions": [
                    {
                      "id": "clx1234567890abcdef",
                      "channelId": "clx_channel_001",
                      "contactId": "clx_contact_001",
                      "opportunityId": "clx_opportunity_001",
                      "direction": "inbound",
                      "status": "delivered",
                      "subject": "Запрос информации",
                      "content": "Здравствуйте! Интересует ваш продукт.",
                      "duration": null,
                      "recordingUrl": null,
                      "metadata": {},
                      "createdAt": "2024-01-15T10:30:00.000Z",
                      "createdBy": "clx_user_001",
                      "channel": {
                        "id": "clx_channel_001",
                        "code": "email",
                        "name": "Email",
                        "icon": "mail",
                        "color": "#3b82f6"
                      },
                      "contact": {
                        "id": "clx_contact_001",
                        "name": "Иван Петров"
                      }
                    }
                  ],
                  "total": 1
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "contactId": {
                    "type": "string"
                  },
                  "channelId": {
                    "type": "string"
                  },
                  "opportunityId": {
                    "type": "string"
                  },
                  "direction": {
                    "type": "string",
                    "enum": [
                      "inbound",
                      "outbound"
                    ],
                    "description": "Направление: inbound - входящее, outbound - исходящее"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "pending",
                      "sent",
                      "delivered",
                      "read",
                      "failed"
                    ],
                    "description": "Статус: pending - ожидает, sent - отправлено, delivered - доставлено, read - прочитано, failed - ошибка"
                  },
                  "dateFrom": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "dateTo": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "limit": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 100,
                    "default": 50
                  },
                  "offset": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 0
                  }
                },
                "description": "Фильтры для поиска взаимодействий"
              },
              "example": {
                "contactId": "clx_contact_001",
                "channelId": "clx_channel_001",
                "direction": "inbound",
                "limit": 50,
                "offset": 0
              }
            }
          }
        }
      }
    },
    "/api/interactions": {
      "post": {
        "summary": "Создать взаимодействие",
        "description": "Создаёт новое взаимодействие (сообщение, звонок и т.д.).\n\n**Используется для:**\n- Входящих webhook от внешних систем (Telegram, WhatsApp и т.д.)\n- Отправки исходящих сообщений из CRM\n\n**Обязательные поля:**\n- `channelId` — ID канала коммуникации\n- `contactId` — ID контакта\n- `direction` — направление (inbound для входящих, outbound для исходящих)\n- `content` — текст сообщения\n\n**Опциональные поля:**\n- `opportunityId` — привязка к сделке\n- `status` — статус доставки (по умолчанию pending)\n- `subject` — тема (для email)\n- `duration` — длительность в секундах (для звонков)\n- `recordingUrl` — URL записи (для звонков)\n- `metadata` — дополнительные данные",
        "tags": [
          "Взаимодействия"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "channelId": {
                      "type": "string",
                      "description": "ID канала"
                    },
                    "contactId": {
                      "type": "string",
                      "description": "ID контакта"
                    },
                    "opportunityId": {
                      "type": "string"
                    },
                    "direction": {
                      "type": "string",
                      "enum": [
                        "inbound",
                        "outbound"
                      ],
                      "description": "Направление"
                    },
                    "status": {
                      "type": "string",
                      "enum": [
                        "pending",
                        "sent",
                        "delivered",
                        "read",
                        "failed"
                      ],
                      "description": "Статус"
                    },
                    "subject": {
                      "type": "string"
                    },
                    "content": {
                      "type": "string",
                      "description": "Содержимое"
                    },
                    "duration": {
                      "type": "number"
                    },
                    "recordingUrl": {
                      "type": "string"
                    },
                    "metadata": {
                      "type": "object",
                      "additionalProperties": {},
                      "description": "Метаданные"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "createdBy": {
                      "type": "string"
                    },
                    "channel": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "code": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        },
                        "icon": {
                          "type": "string"
                        },
                        "color": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "code",
                        "name",
                        "icon",
                        "color"
                      ],
                      "description": "Канал (embedded)"
                    },
                    "contact": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Контакт (embedded)"
                    }
                  },
                  "required": [
                    "id",
                    "channelId",
                    "contactId",
                    "direction",
                    "status",
                    "content",
                    "metadata",
                    "createdAt"
                  ],
                  "description": "Взаимодействие"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "channelId": "clx_channel_001",
                  "contactId": "clx_contact_001",
                  "opportunityId": "clx_opportunity_001",
                  "direction": "inbound",
                  "status": "delivered",
                  "subject": "Запрос информации",
                  "content": "Здравствуйте! Интересует ваш продукт.",
                  "duration": null,
                  "recordingUrl": null,
                  "metadata": {},
                  "createdAt": "2024-01-15T10:30:00.000Z",
                  "createdBy": "clx_user_001",
                  "channel": {
                    "id": "clx_channel_001",
                    "code": "email",
                    "name": "Email",
                    "icon": "mail",
                    "color": "#3b82f6"
                  },
                  "contact": {
                    "id": "clx_contact_001",
                    "name": "Иван Петров"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "channelId": {
                    "type": "string",
                    "description": "ID канала коммуникации",
                    "minLength": 1
                  },
                  "contactId": {
                    "type": "string",
                    "description": "ID контакта",
                    "minLength": 1
                  },
                  "opportunityId": {
                    "type": "string"
                  },
                  "direction": {
                    "type": "string",
                    "enum": [
                      "inbound",
                      "outbound"
                    ],
                    "description": "Направление взаимодействия"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "pending",
                      "sent",
                      "delivered",
                      "read",
                      "failed"
                    ],
                    "description": "Статус: pending - ожидает, sent - отправлено, delivered - доставлено, read - прочитано, failed - ошибка",
                    "default": "pending"
                  },
                  "subject": {
                    "type": "string",
                    "maxLength": 200
                  },
                  "content": {
                    "type": "string",
                    "description": "Содержимое сообщения",
                    "minLength": 1
                  },
                  "duration": {
                    "type": "integer",
                    "minimum": 0
                  },
                  "recordingUrl": {
                    "type": "string",
                    "format": "uri"
                  },
                  "metadata": {
                    "type": "object",
                    "additionalProperties": {},
                    "default": {}
                  }
                },
                "required": [
                  "channelId",
                  "contactId",
                  "direction",
                  "content"
                ],
                "description": "Данные для создания взаимодействия"
              },
              "example": {
                "channelId": "clx_channel_001",
                "contactId": "clx_contact_001",
                "direction": "inbound",
                "status": "delivered",
                "content": "Здравствуйте! Интересует ваш продукт.",
                "metadata": {
                  "source": "webhook",
                  "externalId": "ext_12345"
                }
              }
            }
          }
        }
      }
    },
    "/api/interactions/{id}": {
      "get": {
        "summary": "Получить взаимодействие по ID",
        "description": "Возвращает детальную информацию о взаимодействии, включая данные канала и контакта.",
        "tags": [
          "Взаимодействия"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "channelId": {
                      "type": "string",
                      "description": "ID канала"
                    },
                    "contactId": {
                      "type": "string",
                      "description": "ID контакта"
                    },
                    "opportunityId": {
                      "type": "string"
                    },
                    "direction": {
                      "type": "string",
                      "enum": [
                        "inbound",
                        "outbound"
                      ],
                      "description": "Направление"
                    },
                    "status": {
                      "type": "string",
                      "enum": [
                        "pending",
                        "sent",
                        "delivered",
                        "read",
                        "failed"
                      ],
                      "description": "Статус"
                    },
                    "subject": {
                      "type": "string"
                    },
                    "content": {
                      "type": "string",
                      "description": "Содержимое"
                    },
                    "duration": {
                      "type": "number"
                    },
                    "recordingUrl": {
                      "type": "string"
                    },
                    "metadata": {
                      "type": "object",
                      "additionalProperties": {},
                      "description": "Метаданные"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "createdBy": {
                      "type": "string"
                    },
                    "channel": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "code": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        },
                        "icon": {
                          "type": "string"
                        },
                        "color": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "code",
                        "name",
                        "icon",
                        "color"
                      ],
                      "description": "Канал (embedded)"
                    },
                    "contact": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Контакт (embedded)"
                    }
                  },
                  "required": [
                    "id",
                    "channelId",
                    "contactId",
                    "direction",
                    "status",
                    "content",
                    "metadata",
                    "createdAt"
                  ],
                  "description": "Взаимодействие"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "channelId": "clx_channel_001",
                  "contactId": "clx_contact_001",
                  "opportunityId": "clx_opportunity_001",
                  "direction": "inbound",
                  "status": "delivered",
                  "subject": "Запрос информации",
                  "content": "Здравствуйте! Интересует ваш продукт.",
                  "duration": null,
                  "recordingUrl": null,
                  "metadata": {},
                  "createdAt": "2024-01-15T10:30:00.000Z",
                  "createdBy": "clx_user_001",
                  "channel": {
                    "id": "clx_channel_001",
                    "code": "email",
                    "name": "Email",
                    "icon": "mail",
                    "color": "#3b82f6"
                  },
                  "contact": {
                    "id": "clx_contact_001",
                    "name": "Иван Петров"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID взаимодействия"
          }
        ]
      },
      "patch": {
        "summary": "Обновить взаимодействие",
        "description": "Частично обновляет данные взаимодействия.\n\n**Типичные сценарии:**\n- Обновление статуса доставки (pending → sent → delivered → read)\n- Добавление записи звонка после его завершения\n- Обновление метаданных",
        "tags": [
          "Взаимодействия"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "channelId": {
                      "type": "string",
                      "description": "ID канала"
                    },
                    "contactId": {
                      "type": "string",
                      "description": "ID контакта"
                    },
                    "opportunityId": {
                      "type": "string"
                    },
                    "direction": {
                      "type": "string",
                      "enum": [
                        "inbound",
                        "outbound"
                      ],
                      "description": "Направление"
                    },
                    "status": {
                      "type": "string",
                      "enum": [
                        "pending",
                        "sent",
                        "delivered",
                        "read",
                        "failed"
                      ],
                      "description": "Статус"
                    },
                    "subject": {
                      "type": "string"
                    },
                    "content": {
                      "type": "string",
                      "description": "Содержимое"
                    },
                    "duration": {
                      "type": "number"
                    },
                    "recordingUrl": {
                      "type": "string"
                    },
                    "metadata": {
                      "type": "object",
                      "additionalProperties": {},
                      "description": "Метаданные"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "createdBy": {
                      "type": "string"
                    },
                    "channel": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "code": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        },
                        "icon": {
                          "type": "string"
                        },
                        "color": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "code",
                        "name",
                        "icon",
                        "color"
                      ],
                      "description": "Канал (embedded)"
                    },
                    "contact": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "description": "Контакт (embedded)"
                    }
                  },
                  "required": [
                    "id",
                    "channelId",
                    "contactId",
                    "direction",
                    "status",
                    "content",
                    "metadata",
                    "createdAt"
                  ],
                  "description": "Взаимодействие"
                },
                "example": {
                  "id": "clx1234567890abcdef",
                  "channelId": "clx_channel_001",
                  "contactId": "clx_contact_001",
                  "opportunityId": "clx_opportunity_001",
                  "direction": "inbound",
                  "status": "read",
                  "subject": "Запрос информации",
                  "content": "Здравствуйте! Интересует ваш продукт.",
                  "duration": null,
                  "recordingUrl": null,
                  "metadata": {},
                  "createdAt": "2024-01-15T10:30:00.000Z",
                  "createdBy": "clx_user_001",
                  "channel": {
                    "id": "clx_channel_001",
                    "code": "email",
                    "name": "Email",
                    "icon": "mail",
                    "color": "#3b82f6"
                  },
                  "contact": {
                    "id": "clx_contact_001",
                    "name": "Иван Петров"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID взаимодействия"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": [
                      "pending",
                      "sent",
                      "delivered",
                      "read",
                      "failed"
                    ],
                    "description": "Статус: pending - ожидает, sent - отправлено, delivered - доставлено, read - прочитано, failed - ошибка"
                  },
                  "subject": {
                    "type": "string",
                    "maxLength": 200
                  },
                  "content": {
                    "type": "string",
                    "minLength": 1
                  },
                  "duration": {
                    "type": "integer",
                    "minimum": 0
                  },
                  "recordingUrl": {
                    "type": "string",
                    "format": "uri"
                  },
                  "metadata": {
                    "type": "object",
                    "additionalProperties": {}
                  }
                },
                "description": "Данные для обновления взаимодействия"
              },
              "example": {
                "status": "read"
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Удалить взаимодействие",
        "description": "Полностью удаляет взаимодействие из системы.",
        "tags": [
          "Взаимодействия"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ"
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID взаимодействия"
          }
        ]
      }
    },
    "/api/channels/search": {
      "post": {
        "summary": "Получить список каналов",
        "description": "Возвращает список всех каналов коммуникации.\n\n**Каналы коммуникации** — это способы связи с контактами:\n- Email\n- Телефон (звонки)\n- SMS\n- Мессенджеры (Telegram, WhatsApp, Viber)\n- Социальные сети (Facebook, Instagram, LinkedIn)\n- Веб-чат\n- Видеоконференции (Zoom, Google Meet)\n\nКаждый канал имеет:\n- `code` — уникальный код для идентификации\n- `icon` — название иконки из набора Lucide\n- `color` — цвет для отображения в интерфейсе",
        "tags": [
          "Каналы"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "channels": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Уникальный идентификатор"
                          },
                          "code": {
                            "type": "string",
                            "description": "Код канала"
                          },
                          "name": {
                            "type": "string",
                            "description": "Название"
                          },
                          "icon": {
                            "type": "string",
                            "description": "Иконка"
                          },
                          "color": {
                            "type": "string",
                            "description": "Цвет"
                          },
                          "isActive": {
                            "type": "boolean",
                            "description": "Активен ли канал"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата создания"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Дата обновления"
                          }
                        },
                        "required": [
                          "id",
                          "code",
                          "name",
                          "icon",
                          "color",
                          "isActive",
                          "createdAt",
                          "updatedAt"
                        ],
                        "description": "Канал коммуникации"
                      },
                      "description": "Список каналов"
                    },
                    "total": {
                      "type": "number",
                      "description": "Общее количество"
                    }
                  },
                  "required": [
                    "channels",
                    "total"
                  ],
                  "description": "Список каналов"
                },
                "example": {
                  "channels": [
                    {
                      "id": "clx_channel_001",
                      "code": "telegram",
                      "name": "Telegram",
                      "icon": "send",
                      "color": "#0088cc",
                      "isActive": true,
                      "createdAt": "2024-01-15T10:30:00.000Z",
                      "updatedAt": "2024-01-15T10:30:00.000Z"
                    },
                    {
                      "id": "clx_channel_002",
                      "code": "email",
                      "name": "Email",
                      "icon": "mail",
                      "color": "#3b82f6",
                      "isActive": true,
                      "createdAt": "2024-01-15T10:30:00.000Z",
                      "updatedAt": "2024-01-15T10:30:00.000Z"
                    },
                    {
                      "id": "clx_channel_003",
                      "code": "phone",
                      "name": "Телефон",
                      "icon": "phone",
                      "color": "#22c55e",
                      "isActive": true,
                      "createdAt": "2024-01-15T10:30:00.000Z",
                      "updatedAt": "2024-01-15T10:30:00.000Z"
                    }
                  ],
                  "total": 3
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {}
              }
            }
          }
        }
      }
    },
    "/api/channels": {
      "post": {
        "summary": "Создать канал",
        "description": "Создаёт новый канал коммуникации.\n\n**Правила для кода:**\n- Только латинские буквы в нижнем регистре, цифры и символ `_`\n- Должен начинаться с буквы\n- Уникальный в системе\n\n**Иконки:**\nИспользуются иконки из библиотеки [Lucide](https://lucide.dev/icons/).\nПопулярные: mail, phone, send, message-circle, video, globe.",
        "tags": [
          "Каналы"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "code": {
                      "type": "string",
                      "description": "Код канала"
                    },
                    "name": {
                      "type": "string",
                      "description": "Название"
                    },
                    "icon": {
                      "type": "string",
                      "description": "Иконка"
                    },
                    "color": {
                      "type": "string",
                      "description": "Цвет"
                    },
                    "isActive": {
                      "type": "boolean",
                      "description": "Активен ли канал"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "code",
                    "name",
                    "icon",
                    "color",
                    "isActive",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Канал коммуникации"
                },
                "example": {
                  "id": "clx_channel_001",
                  "code": "telegram",
                  "name": "Telegram",
                  "icon": "send",
                  "color": "#0088cc",
                  "isActive": true,
                  "createdAt": "2024-01-15T10:30:00.000Z",
                  "updatedAt": "2024-01-15T10:30:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "code": {
                    "type": "string",
                    "description": "Уникальный код канала",
                    "minLength": 1,
                    "maxLength": 50,
                    "pattern": "^[a-z][a-z0-9_]*$"
                  },
                  "name": {
                    "type": "string",
                    "description": "Название канала",
                    "minLength": 1,
                    "maxLength": 100
                  },
                  "icon": {
                    "type": "string",
                    "maxLength": 50,
                    "default": "message-circle"
                  },
                  "color": {
                    "type": "string",
                    "pattern": "^#[0-9a-fA-F]{6}$",
                    "default": "#6b7280"
                  },
                  "isActive": {
                    "type": "boolean",
                    "default": true
                  }
                },
                "required": [
                  "code",
                  "name"
                ],
                "description": "Данные для создания канала"
              },
              "example": {
                "code": "telegram",
                "name": "Telegram",
                "icon": "send",
                "color": "#0088cc",
                "isActive": true
              }
            }
          }
        }
      }
    },
    "/api/channels/{id}": {
      "get": {
        "summary": "Получить канал по ID",
        "description": "Возвращает информацию о канале коммуникации.",
        "tags": [
          "Каналы"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "code": {
                      "type": "string",
                      "description": "Код канала"
                    },
                    "name": {
                      "type": "string",
                      "description": "Название"
                    },
                    "icon": {
                      "type": "string",
                      "description": "Иконка"
                    },
                    "color": {
                      "type": "string",
                      "description": "Цвет"
                    },
                    "isActive": {
                      "type": "boolean",
                      "description": "Активен ли канал"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "code",
                    "name",
                    "icon",
                    "color",
                    "isActive",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Канал коммуникации"
                },
                "example": {
                  "id": "clx_channel_001",
                  "code": "telegram",
                  "name": "Telegram",
                  "icon": "send",
                  "color": "#0088cc",
                  "isActive": true,
                  "createdAt": "2024-01-15T10:30:00.000Z",
                  "updatedAt": "2024-01-15T10:30:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID канала"
          }
        ]
      },
      "patch": {
        "summary": "Обновить канал",
        "description": "Частично обновляет данные канала. Код канала изменить нельзя.",
        "tags": [
          "Каналы"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "Уникальный идентификатор"
                    },
                    "code": {
                      "type": "string",
                      "description": "Код канала"
                    },
                    "name": {
                      "type": "string",
                      "description": "Название"
                    },
                    "icon": {
                      "type": "string",
                      "description": "Иконка"
                    },
                    "color": {
                      "type": "string",
                      "description": "Цвет"
                    },
                    "isActive": {
                      "type": "boolean",
                      "description": "Активен ли канал"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата создания"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Дата обновления"
                    }
                  },
                  "required": [
                    "id",
                    "code",
                    "name",
                    "icon",
                    "color",
                    "isActive",
                    "createdAt",
                    "updatedAt"
                  ],
                  "description": "Канал коммуникации"
                },
                "example": {
                  "id": "clx_channel_001",
                  "code": "telegram",
                  "name": "Telegram Bot",
                  "icon": "send",
                  "color": "#229ED9",
                  "isActive": true,
                  "createdAt": "2024-01-15T10:30:00.000Z",
                  "updatedAt": "2024-01-15T10:30:00.000Z"
                }
              }
            }
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID канала"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 100
                  },
                  "icon": {
                    "type": "string",
                    "maxLength": 50
                  },
                  "color": {
                    "type": "string",
                    "pattern": "^#[0-9a-fA-F]{6}$"
                  },
                  "isActive": {
                    "type": "boolean"
                  }
                },
                "description": "Данные для обновления канала"
              },
              "example": {
                "name": "Telegram Bot",
                "color": "#229ED9"
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Удалить канал",
        "description": "Удаляет канал коммуникации.\n\n**Внимание:** При удалении канала все связанные взаимодействия сохраняются,\nно будут отображаться без информации о канале.",
        "tags": [
          "Каналы"
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ"
          },
          "401": {
            "description": "Не авторизован",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Внутренняя ошибка сервера",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID канала"
          }
        ]
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      },
      "cookieAuth": {
        "type": "apiKey",
        "in": "cookie",
        "name": "next-auth.session-token"
      }
    }
  },
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "tags": [
    {
      "name": "Контакты"
    },
    {
      "name": "Пользователи"
    },
    {
      "name": "Сделки"
    },
    {
      "name": "Словари"
    },
    {
      "name": "Элементы словаря"
    },
    {
      "name": "Взаимодействия"
    },
    {
      "name": "Каналы"
    }
  ]
}